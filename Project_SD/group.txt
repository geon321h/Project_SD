-- GROUP TABLE --
DROP SEQUENCE GROUPSD_SEQ;
CREATE SEQUENCE GROUPSD_SEQ
INCREMENT BY 1
START WITH 1
MINVALUE 1
;

DROP TABLE GROUPSD CASCADE CONSTRAINTS;
CREATE TABLE GROUPSD(
 GROUP_NO NUMBER PRIMARY KEY,
 GROUP_NAME VARCHAR2(24) NOT NULL, -- 한글 8글자
 GROUP_MANAGER_NO NUMBER NOT NULL REFERENCES USERSD(NO) ON DELETE CASCADE,
 GROUP_CREATE_DAY DATE DEFAULT SYSDATE
);

-- GROUPSD_USER_LIST TABLE --
DROP TABLE GROUPSD_USER_LIST CASCADE CONSTRAINTS;
CREATE TABLE GROUPSD_USER_LIST(
 GROUP_NO NUMBER,
 USER_NO NUMBER,
 GROUP_CHECK VARCHAR2(2) DEFAULT 'N' CHECK(GROUP_CHECK IN('Y','N'))
 , CONSTRAINT GROUPSD_USER_LIST_PK PRIMARY KEY (GROUP_NO, USER_NO)
);

insert all 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'거니의 그룹',1)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,1,'Y')
select * from dual;

insert all 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'3월모임',2)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,2,'Y')
select * from dual;

INSERT ALL 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'가나다라',3)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,3,'Y')
select * from dual;

INSERT ALL 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'그룹그룹그룹',1)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,1,'Y')
select * from dual;

INSERT ALL 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'스터디그룹',1)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,1,'Y')
select * from dual;

INSERT ALL 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'디비디비',6)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,6,'Y')
select * from dual;

INSERT ALL 
  INTO GROUPSD(GROUP_NO,GROUP_NAME,GROUP_MANAGER_NO) 
  VALUES (GROUPSD_SEQ.NEXTVAL,'자바',7)
  INTO GROUPSD_USER_LIST 
  VALUES (GROUPSD_SEQ.NEXTVAL,7,'Y')
select * from dual;

INSERT INTO GROUPSD_USER_LIST VALUES (1,2,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (1,3,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (1,4,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (1,5,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (1,7,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (1,8,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (2,7,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (2,8,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (3,1,'Y');
INSERT INTO GROUPSD_USER_LIST VALUES (7,1,'N');
INSERT INTO GROUPSD_USER_LIST VALUES (6,1,'N');
INSERT INTO GROUPSD_USER_LIST VALUES (6,2,'Y');

-- GROUPSD_WRITING_LIST TABLE --
DROP TABLE GROUPSD_WRITING_LIST CASCADE CONSTRAINTS;
CREATE TABLE GROUPSD_WRITING_LIST(
 GROUP_NO NUMBER REFERENCES GROUPSD(GROUP_NO) ON DELETE CASCADE,
 GROUP_WRITING_NO NUMBER ,
 GROUP_WRITING_TITLE VARCHAR2(80) NOT NULL , -- .getBytes().length;
 GROUP_WRITING_CONTENT VARCHAR2(1000),
 GROUP_WRITING_DAY DATE DEFAULT SYSDATE,
 GROUP_WRITING_USER_NO NUMBER REFERENCES USERSD(NO) ON DELETE CASCADE
 ,CONSTRAINT GROUPSD_WRITING_LIST_PK PRIMARY KEY (GROUP_NO, GROUP_WRITING_NO)
);



INSERT INTO GROUPSD_WRITING_LIST
VALUES (1,(SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST)
        ,'첫 게시글','첫 게시글 입니다. 그룹 잘 사용해 주세요.',SYSDATE,1);
INSERT INTO GROUPSD_WRITING_LIST
VALUES (1,(SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST)
        ,'안녕하세요','만나서 반가워요~~~~~~',SYSDATE,3);
INSERT INTO GROUPSD_WRITING_LIST
VALUES (1,(SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST)
        ,'자바','자바 프로젝트 진행중 입니다. ',SYSDATE,2);
INSERT INTO GROUPSD_WRITING_LIST
VALUES (2,(SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST)
        ,'그룹2번 입니다~','글써주세요~!!!!!!',SYSDATE,1);
INSERT INTO GROUPSD_WRITING_LIST
VALUES (1,(SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST)
        ,'신참입니다','오늘은 날이 좋네요',SYSDATE,7);

SELECT * FROM GROUPSD;
SELECT * FROM GROUPSD_USER_LIST;
SELECT * FROM GROUPSD_WRITING_LIST;

SELECT NVL(MAX(GROUP_WRITING_NO),0)+1 FROM GROUPSD_WRITING_LIST;
SELECT lengthb('게시글 제목 몇 글자로 해야할지모르겠다') FROM DUAL;






